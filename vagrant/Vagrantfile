# -*- mode: ruby -*-
# vi: set ft=ruby :

Vagrant.configure(2) do |config|
    config.vm.box = "ubuntu/trusty64"
    config.vm.network :forwarded_port, guest: 30000, host: 3000
    config.vm.provision :shell, path: "update.sh"
   #config.vm.provision :shell, privileged: false, path: "ruby.sh"

    config.vm.provision :shell, privileged: false, inline: <<-SHELL
        git clone https://github.com/rbenv/rbenv.git ~/.rbenv
        git clone https://github.com/rbenv/ruby-build.git ~/.rbenv/plugins/ruby-build

        RBENV_PATH='export PATH="$HOME/.rbenv/bin:$PATH"'
        echo $RBENV_PATH >> ~/.bash_profile
        RBENV_INIT='eval "$(rbenv init -)"'
        echo $RBENV_INIT >> ~/.bash_profile
    SHELL

    config.vm.provision :shell, privileged: false, inline: <<-SHELL
        rbenv install 2.3.1
        rbenv global 2.3.1
    SHELL

    config.vm.provision :shell, privileged: false, inline: <<-SHELL
        gem install bundler
    SHELL

    config.vm.provision :shell, privileged: false, inline: <<-SHELL
        cd /vagrant
        rm -rf Hours
        git clone https://github.com/DefactoSoftware/Hours.git

        cd Hours        
        bundle install

        #./bin/setup
        #foreman start
    SHELL
end
